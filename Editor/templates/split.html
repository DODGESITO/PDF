{% extends 'layout/nav.html' %} {% load static %} {% block cont %}
<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Dividir PDFs</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="{% static 'css/split.css' %}" />
  </head>
  <body>
    <!-- Background Effects -->
    <div class="background-effects">
      <div class="blob blob-1"></div>
      <div class="blob blob-2"></div>
    </div>

    <div class="container">
      <!-- Header Section -->
      <div class="header-section">
        <div class="tool-icon">
          <svg
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
          >
            <circle cx="8" cy="18" r="4" />
            <path d="m12 18 2-2m0 0 2-2m-2 2-2-2m2 2 2 2" />
            <path
              d="M10.3 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2v7"
            />
          </svg>
        </div>
        <h1>Dividir PDFs</h1>
        <p class="subtitle">Separa páginas específicas de tu documento PDF</p>
      </div>

      <!-- Main Card -->
      <div class="main-card">
        <!-- File Upload Section -->
        <div class="upload-section">
          <div class="upload-area" id="uploadArea">
            <div class="upload-icon">
              <svg
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
              >
                <path
                  d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"
                />
                <polyline points="14,2 14,8 20,8" />
              </svg>
            </div>
            <h3>Selecciona un archivo PDF</h3>
            <p>Arrastra y suelta un archivo PDF aqui</p>
            <input type="file" id="pdfFile" accept=".pdf" hidden />
            <button type="button" class="select-btn" id="selectBtn">
              <svg
                class="btn-icon"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
              >
                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4" />
                <polyline points="17,8 12,3 7,8" />
                <line x1="12" y1="3" x2="12" y2="15" />
              </svg>
              Seleccionar PDF
            </button>
          </div>

          <!-- Selected File Display -->
          <div class="selected-file" id="selectedFile" style="display: none">
            <div class="file-info">
              <svg
                class="file-icon"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
              >
                <path
                  d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"
                />
                <polyline points="14,2 14,8 20,8" />
              </svg>
              <div class="file-details">
                <span class="file-name" id="fileName"></span>
                <span class="file-size" id="fileSize"></span>
                <span
                  class="page-count"
                  id="pageCount"
                  style="display: none"
                ></span>
              </div>
            </div>
            <button type="button" class="remove-file" id="removeBtn">
              <svg
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
              >
                <line x1="18" y1="6" x2="6" y2="18" />
                <line x1="6" y1="6" x2="18" y2="18" />
              </svg>
            </button>
          </div>
        </div>

        <!-- Split Form -->
        <form id="pdfSplitForm" class="split-form" style="display: none">
          {% csrf_token %}

          <div class="form-group">
            <label for="split_method">Método de división:</label>
            <select id="split_method" name="split_method" class="form-select">
              <option value="pages_per_file">Por número de páginas</option>
              <option value="page_range">Por rango de páginas</option>
              <option value="extract_pages">Extraer páginas específicas</option>
            </select>
          </div>

          <div id="pages_per_file_group" class="form-group">
            <label for="pages_per_file">Páginas por archivo de salida:</label>
            <input
              type="number"
              id="pages_per_file"
              name="pages_per_file"
              value="1"
              min="1"
              class="form-input"
            />
          </div>

          <div id="page_range_group" class="form-group" style="display: none">
            <label for="start_page">Página inicial:</label>
            <input
              type="number"
              id="start_page"
              name="start_page"
              min="1"
              class="form-input"
              placeholder="ej. 1"
            />
            <label for="end_page">Página final:</label>
            <input
              type="number"
              id="end_page"
              name="end_page"
              min="1"
              class="form-input"
              placeholder="ej. 5"
            />
          </div>

          <div
            id="extract_pages_group"
            class="form-group"
            style="display: none"
          >
            <label for="extract_method">Método de extracción:</label>
            <select
              id="extract_method"
              name="extract_method"
              class="form-select"
            >
              <option value="specification">
                Por especificación de páginas
              </option>
              <option value="visual_selection">Por selección visual</option>
            </select>

            <!-- Especificación de páginas -->
            <div id="specification_group" class="sub-form-group">
              <label for="pages_specification"
                >Páginas a extraer (ej: 1, 3-5, 9, 12-15):</label
              >
              <textarea
                id="pages_specification"
                name="pages_specification"
                class="form-textarea"
                placeholder="1, 3-5, 9, 12-15"
                rows="3"
              ></textarea>
              <div class="specification-help">
                <small>
                  • Páginas individuales: 1, 5, 9<br />
                  • Rangos: 3-7, 10-15<br />
                  • Combinado: 1, 3-5, 9, 12-15
                </small>
              </div>
              <div class="extract-actions">
                <button type="button" id="previewBtn" class="btn btn-secondary">
                  <svg
                    class="btn-icon"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                  >
                    <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z" />
                    <circle cx="12" cy="12" r="3" />
                  </svg>
                  Vista Previa
                </button>
                <button
                  type="button"
                  id="clearSelectionBtn"
                  class="btn btn-outline"
                >
                  <svg
                    class="btn-icon"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                  >
                    <path d="M3 6h18" />
                    <path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6" />
                    <path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2" />
                  </svg>
                  Limpiar
                </button>
              </div>
            </div>

            <!-- Selección visual -->
            <div
              id="visual_selection_group"
              class="sub-form-group"
              style="display: none"
            >
              <div class="visual-selection-info">
                <p>
                  Selecciona las páginas haciendo clic en las vistas previas:
                </p>
                <div class="selection-controls">
                  <button
                    type="button"
                    id="loadAllPagesBtn"
                    class="btn btn-secondary"
                  >
                    <svg
                      class="btn-icon"
                      viewBox="0 0 24 24"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="2"
                    >
                      <path
                        d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"
                      />
                      <polyline points="14,2 14,8 20,8" />
                    </svg>
                    Cargar Todas las Páginas
                  </button>
                  <button
                    type="button"
                    id="selectAllPagesBtn"
                    class="btn btn-outline"
                    style="display: none"
                  >
                    Seleccionar Grupo
                  </button>
                  <button
                    type="button"
                    id="clearAllPagesBtn"
                    class="btn btn-outline"
                    style="display: none"
                  >
                    Limpiar Selección de Grupo
                  </button>
                </div>
              </div>
            </div>
          </div>

          <button type="submit" id="splitBtn" class="btn btn-success">
            <svg
              class="btn-icon"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
            >
              <circle cx="8" cy="18" r="4" />
              <path d="m12 18 2-2m0 0 2-2m-2 2-2-2m2 2 2 2" />
              <path d="M10.3 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2 2v7" />
            </svg>
            <span id="splitBtnText">Dividir PDF</span>
          </button>
        </form>
      </div>

      <!-- Page Preview Section -->
      <div id="previewSection" class="preview-section" style="display: none">
        <div class="preview-header">
          <h3>Vista Previa de Páginas</h3>
          <div class="preview-info">
            <span id="selectedPagesInfo">0 páginas seleccionadas</span>
          </div>
        </div>

        <!-- Page Navigation -->
        <div class="page-navigation" id="pageNavigation" style="display: none">
          <button type="button" id="prevGroupBtn" class="nav-btn" disabled>
            <svg
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
            >
              <polyline points="15,18 9,12 15,6" />
            </svg>
            Anterior
          </button>
          <div class="nav-info">
            <div class="group-number" id="groupInfo">Grupo 1 de 1</div>
            <div class="page-range" id="pageRangeInfo">Páginas 1-12</div>
          </div>
          <button type="button" id="nextGroupBtn" class="nav-btn" disabled>
            Siguiente
            <svg
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
            >
              <polyline points="9,18 15,12 9,6" />
            </svg>
          </button>
        </div>

        <!-- Page Grid -->
        <div class="page-grid" id="pageGrid"></div>
      </div>

      <!-- Instructions -->
      <div class="instructions-card">
        <h4>Instrucciones:</h4>
        <ul>
          <li>
            <strong>Por número de páginas:</strong> Divide el PDF en archivos
            con el número de páginas especificado
          </li>
          <li>
            <strong>Por rango de páginas:</strong> Extrae páginas específicas
            del documento original
          </li>
          <li>
            <strong>Extraer páginas específicas:</strong> Selecciona páginas
            individuales o rangos con vista previa
          </li>
          <li>Los archivos resultantes se descargarán automáticamente</li>
          <li>Tamaño máximo recomendado: 50MB por archivo</li>
        </ul>
      </div>
    </div>

    <!-- Messages -->
    <div id="messages" class="messages"></div>

    <!-- Loading -->
    <div id="loading" class="loading" style="display: none">
      <div class="spinner"></div>
      <p id="loadingText">Procesando PDF...</p>
    </div>

    <script src="{% static 'script/split.js' %}"></script>
  </body>
</html>
{% endblock %}
